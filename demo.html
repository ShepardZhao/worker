<!doctype html>
<html>
	<head>
		<title>web worker example</title>
	</head>

	<body>
    <h1>Look In The Console</h1>
		<script src="src/worker.js"></script>
		<script>
      // Create your web worker
			var myWorker = $worker().create(function() {
        request('/bower.json', function(data) {
          self.postMessage(data);
        });

        request('/package.json', function(data) {
          self.postMessage(data);
        });
	    });

      // Load our request method into the worker
	    myWorker.loadScripts({
	    	request: request
	    });

      // Listen for the data to come back
	    myWorker.onmessage = function(res) {
        console.log(res.data);
	    };

      // Fire off the worker
	    myWorker.postMessage();

      // Use the same method outside of the worker!
      request('/demo.html', function(data) {
        console.log(data);
      });

      // My Request method
      function request(path, cb) {
        var oReq = new XMLHttpRequest();

        oReq.onload = function() {
          cb({
            key: path,
            content: this.responseText
          });
        };

        oReq.open('GET', 'http://localhost:8080' + path, true);

        oReq.send();
      }
		</script>
	</body>
</html>
